name: ü§ñ Auto Respond [Discussions|Issues|PRs] ‚ÑπÔ∏è

on:
  issues:
    types: [opened]
  pull_request:
    types: [opened]
  discussion:
    types: [created]

jobs:
  auto-respond:
    runs-on: ubuntu-latest
    steps:
      - name: Get GitHub context
        run: |
          echo "Repository: ${{ github.repository }}"
          echo "Branch: ${{ github.ref }}"
          echo "Actor: ${{ github.actor }}"
          echo "Event: ${{ github.event_name }}"
          if [[ "${{ github.event_name }}" == "pull_request" ]]; then
            echo "This is a pull request event. Comments URL: ${{ github.event.pull_request.comments_url }}"
          elif [[ "${{ github.event_name }}" == "issues" ]]; then
            echo "This is an issue event. Comments URL: ${{ github.event.issue.comments_url }}"
          elif [[ "${{ github.event_name }}" == "push" ]]; then
            echo "This is a push event. No comments URL available."
          else
            echo "Unknown event: ${{ github.event_name }}"
          fi

      - uses: actions/github-script@v7
        with:
          github-token: ${{ secrets.GITHUB_TOKEN }}
          script: |
            // Debug: Log the entire context
            console.log('Full GitHub Context:', JSON.stringify(github, null, 2));
            
            // Explicitly extract event name and payload
            const eventName = github.context.eventName || process.env.GITHUB_EVENT_NAME;
            const payload = github.context.payload;
            
            console.log('Event Name:', eventName);
            console.log('Payload:', JSON.stringify(payload, null, 2));
      
            const messages = {
              issue: `ü§ñ **Automated Response** <br> 
              Thanks for opening this issue! <br> 
              **Quick Details:** <br> 
              - üìã We'll review it shortly <br> 
              - üïí Typical response time is 12-24 hours <br> 
              *Want faster resolution or more community support?* <br> 
              **Join Our Discord:** https://discord.gg/djJUs48Zbu <br> 
              Connect directly with our team, get quicker responses, and engage with our community!`,
              
              pullRequest: `ü§ñ **Automated Response** <br> 
              Thanks for opening this pull request! <br> 
              **Quick Details:** <br> 
              - üìã We'll review it shortly <br> 
              - üïí Typical response time is 12-24 hours <br> 
              *Want faster resolution or more community support?* <br> 
              **Join Our Discord:** https://discord.gg/djJUs48Zbu <br> 
              Connect directly with our team, get quicker responses, and engage with our community!`,
              
              discussion: `ü§ñ **Automated Response** <br> 
              Thanks for starting this discussion! <br> 
              **Quick Details:** <br> 
              - üí¨ We're excited to hear your thoughts <br> 
              - üïí Typical response time is 12-24 hours <br> 
              *Want to connect more with our team and community?* <br> 
              **Join Our Discord:** https://discord.gg/djJUs48Zbu <br> 
              Dive deeper with us and get involved!`
            };
      
            let number, message;
            try {
              switch (eventName) {
                case 'issues':
                  number = payload.issue.number;
                  message = messages.issue;
                  break;
                case 'pull_request':
                  number = payload.pull_request.number;
                  message = messages.pullRequest;
                  break;
                case 'discussion':
                  number = payload.discussion.number;
                  message = messages.discussion;
                  break;
                default:
                  console.log(`Unsupported event type: ${eventName}`);
                  return;
              }
      
              // Use the appropriate method based on event type
              if (eventName === 'discussion') {
                await github.rest.discussions.createComment({
                  owner: github.context.repo.owner,
                  repo: github.context.repo.repo,
                  discussion_number: number,
                  body: message
                });
              } else {
                await github.rest.issues.createComment({
                  owner: github.context.repo.owner,
                  repo: github.context.repo.repo,
                  issue_number: number,
                  body: message
                });
              }
            } catch (error) {
              console.error('Error in script:', error);
              throw error;
            }
